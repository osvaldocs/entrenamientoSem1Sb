spring.application.name=demo

# ===============================================================================
# H2 Database Configuration
# ===============================================================================
spring.datasource.url=jdbc:h2:mem:demo
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect

# H2 console
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

# ===============================================================================
# Flyway Configuration (HU4)
# ===============================================================================
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true

# ===============================================================================
# SQL Logging Configuration (HU4 - TASK 2: Performance Monitoring)
# ===============================================================================
# Purpose: Enable detailed SQL logging to detect N+1 queries and verify
#          performance improvements after optimizations

# Show SQL queries in console
spring.jpa.show-sql=true

# Format SQL queries for better readability
spring.jpa.properties.hibernate.format_sql=true

# Enable DEBUG level logging for Hibernate SQL
logging.level.org.hibernate.SQL=DEBUG

# Enable TRACE level logging for SQL parameter binding
# This shows the actual values being bound to SQL parameters
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# ===============================================================================
# Batch Fetching Configuration (HU4 - TASK 2: Performance Optimization)
# ===============================================================================
# Configures batch size for fetching lazy collections/associations
# TASK 2: "configuracion de batchSize" para reducir N+1 queries

# When Hibernate loads lazy associations, instead of making N queries (one per entity),
# it batches them into fewer queries (N/batch_size queries).
# Example: 100 events with lazy venue -> Without batch: 100 queries, With batch size 10: 10 queries
spring.jpa.properties.hibernate.default_batch_fetch_size=10

# Additional batch optimizations
spring.jpa.properties.hibernate.jdbc.batch_size=10
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# ===============================================================================
# JWT Configuration (HU5 - TASK 3: Security)
# ===============================================================================
# Secret key for JWT signing (HS256 algorithm)
# IMPORTANT: In production, use environment variable or secure vault
jwt.secret=404E635266556A586E3272357538782F413F4428472B4B6250645367566B5970
jwt.expiration=86400000
# JWT expiration time in milliseconds (86400000 = 24 hours)
jwt.issuer=riwi-events-api

# ===============================================================================
# Structured Logging Configuration (HU5 - TASK 2: Observability)
# ===============================================================================
# Enable logging pattern with timestamp and trace information
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n

# Security logging - authentication and authorization events
logging.level.com.riwi.H4.infrastructure.security=DEBUG
logging.level.org.springframework.security=INFO

# Application logging
logging.level.com.riwi.H4=INFO
